@import com.domain.clans.ClanUtils
@import org.joda.time.LocalDate
@import org.joda.time.LocalTime
@import java.util.Date; var prevDate: org.joda.time.LocalDate = null; var currentDate: org.joda.time.LocalDate = null; var currentTime: String = null
@(battles: Seq[com.domain.presentation.model.StrongholdBattle])(implicit request: RequestHeader)

@main("Strongholds", request.session.get("user")) {

<table align="center" cellpadding="1" cellspacing="1">
    <tr><td>Date&nbsp;</td><td>Attacker&nbsp;</td><td></td><td align="right">Defender&nbsp;</td></tr>
    @for(battle <- battles) {
    @(currentDate = LocalDate.fromDateFields(new Date(battle.date * 1000)))
    @(currentTime = LocalTime.fromDateFields(new Date(battle.date * 1000)).toString("HH:mm"))
    <tr>
        @if(prevDate == currentDate) {
            <td align="right">@currentTime&nbsp;</td>
        } else {
            <td align="right"><b>@currentDate</b> @currentTime&nbsp;</td>
        }
        @(prevDate = currentDate)
        <td>
            <a class="@com.domain.presentation.model.ColorHelper.wn8Color(ClanUtils.getClanCachedWn8(battle.attackerClanTag).getOrElse("0").toString)" href="@routes.ClanDetailsController.details(battle.attackerClanId)">@battle.attackerClanTag</a>&nbsp;
        </td>
        <td>vs</td>
        <td align="right">
            <a class="@com.domain.presentation.model.ColorHelper.wn8Color(ClanUtils.getClanCachedWn8(battle.defenderClanTag).getOrElse("0").toString)" href="@routes.ClanDetailsController.details(battle.defenderClanId)">@battle.defenderClanTag</a>&nbsp;
        </td>
    </tr>
    }
</table>

}